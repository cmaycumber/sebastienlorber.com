---
title: Using Expo in Gatsby
slug: using-expo-in-gatsby
author: Sébastien Lorber
date: 2020-05-08
hero: ./images/hero.png
excerpt: ...or how to use cross-platform components in a MDX blog post
secret: true
---

You probably heard of [React-Native-Web](https://github.com/necolas/react-native-web), allowing to render React-Native views on the web.

**So, why not on a React-based static website, like a Gatsby blog?**

This post is a proof-of-concept: it contains React-Native and Expo interactive components, embedded directly into this [MDX](https://github.com/mdx-js/mdx) article, of my Gatsby site.

If you are not familiar with the React-Native ecosystem:

- React-Native-Web is like a CSS-in-JS library (similar to Emotion) using the React-Native API, with interesting properties (check my post about [atomic CSS-in-JS](https://sebastienlorber.com/atomic-css-in-js)).
- Expo is like an extension of React-Native: it provides much more APIs (camera, battery...), enabling you to build more complex experiences.

---

# gatsby-plugin-react-native-web v3

I'm the maintainer of [gatsby-plugin-react-native-web](https://github.com/slorber/gatsby-plugin-react-native-web), and pleased to announce **version 3.0 is now out of beta**.

It uses under the hood [@expo/webpack-config](https://www.npmjs.com/package/@expo/webpack-config), which permit to get started fast without any config (thanks [Evan Bacon](https://twitter.com/baconbrix)).

After adding the required dependencies, you only need to add the plugin to `gatsby-config.js`, and **nothing else is required** (0 plugin config to provide).

Your favorite ReactNative libs and UI kits should work out of the box, but also Expo APIs supporting the web platform.

**Note**: you can use [React-Native and Expo with NextJS](https://dev.to/evanbacon/next-js-expo-and-react-native-for-web-3kd9) too. [Evanbacon.dev](http://evanbacon.dev/) is build with NextJS and Expo. Actually, you can use [@expo/webpack-config](https://www.npmjs.com/package/@expo/webpack-config) on any project using Webpack.

### Step 1

Add dependencies to `package.json`

```json
{
  "dependencies": {
    "gatsby-plugin-react-native-web": "^3.1.0",
    "@expo/webpack-config": "0.11.19",
    "react-native": "^0.61.0",
    "react-native-web": "^0.11.7",

    // Optional
    "expo": "^36.0.2",
    "react-native-gesture-handler": "^0.6.1",
    "react-native-reanimated": "~1.7.0"
  }
}
```

I use these versions in this website, but you should be fine upgrading them.

### Step 2

Add the plugin in `gatsby-config.js`

```js
module.exports = {
  siteMetadata: {
    title: `Sébastien Lorber`,
    siteUrl: `https://sebastienlorber.com`,
  },
  plugins: [`gatsby-plugin-react-native-web`],
};
```

### Step 3

Just use React-Native and Expo components in your Gatsby site, using React-Native components (check the React-Native-Web and Expo docs for available web platform support).

```jsx
import { TouchableOpacity, Text } from 'react-native';

export const MyTestButton = () => (
  <TouchableOpacity
    onPress={() => alert('onPress')}
    style={{
      padding: 10,
      backgroundColor: 'blue',
      borderRadius: 5,
    }}
  >
    <Text style={{ color: 'white' }}>Click me</Text>
  </TouchableOpacity>
);
```

import { TouchableOpacity, Text } from 'react-native';
import MobilePhoneView from 'components/MobilePhoneView';

<MobilePhoneView
  style={{ alignItems: 'center', justifyContent: 'center' }}
>
  <TouchableOpacity
    onPress={() => alert('press')}
    style={{
      padding: 10,
      backgroundColor: 'blue',
      borderRadius: 5,
    }}
  >
    <Text style={{ color: 'white' }}>Click me</Text>
  </TouchableOpacity>
</MobilePhoneView>

It works in MDX content too. You can easily create an interactive blog post like this one:

```mdx
# Implementing a button in React-Native

Hey, this blog post will show you how you can implement **a button** in React-Native

We will build this button:

import { MyTestButton } from './MyTestButton';

<MyTestButton />
```

---

# Demo time

Keep in mind they are all written with React-Native and Expo components / apis.
There's no usage of a single `div` in the codebase here, or any direct browser API usage, without going through an intermediate layer of React-Native components.

All these demos can also run in iOS and Android (natively, of course), as we'll see later.

import {
  ExpoCameraDemo,
  ExpoDarkModeSwitchDemo,
  ExpoGesturesDemo,
  ExpoSvgDemo,
  ExpoVideoDemo,
  ExpoImagePickerDemo,
} from './components';

So, let's start with a simple one.

Can I render a complex svg with react-native-svg? Yes!

<ExpoSvgDemo />

---

Can I use a cross-platform component (supporting both mobile and web), like [expo-dark-mode-switch](https://github.com/EvanBacon/expo-dark-mode-switch), and wire it to my Gatsby theme-ui state? Yes!

<ExpoDarkModeSwitchDemo />

---

Can I ask your permission to use your camera, and reveal it with a fade-in animation? Yes!

<ExpoCameraDemo />

---

Can I use more complex gesture-based systems? Yes! Demo credits to Evan Bacon.

<ExpoGesturesDemo />

---

Can I play a video? Yes!

<ExpoVideoDemo />

---

Can I build an image picker, and enable a few image transformations? Yes!

<ExpoImagePickerDemo />

---

In case you wonder what the code looks like, here's a snippet for the camera demo.

You can find the rest of the code [here](https://github.com/slorber/sebastienlorber.com/tree/master/content/posts/2020-05-08-using-expo-in-gatsby).

```jsx
import { View, Text } from 'react-native';
import { Camera } from 'expo-camera';
import * as Permissions from 'expo-permissions';

import MobilePhoneView from 'components/MobilePhoneView';
import AppButton from 'components/designSystem/AppButton';
import AppRevealView from 'components/designSystem/AppRevealView';

export const ExpoCameraDemo = () => {
  const [showCamera, setShowCamera] = useState(false);
  return (
    <MobilePhoneView safeAreaPaddingTop={0}>
      {showCamera ? (
        <AppRevealView>
          <Camera style={{ flex: 1, width: '100%' }} />
        </AppRevealView>
      ) : (
        <View style={{ flex: 1, justifyContent: 'center' }}>
          <AppButton
            onPress={async () => {
              const result = await Permissions.askAsync(
                Permissions.CAMERA,
              );
              if (result.status === 'granted') {
                setShowCamera(true);
              }
            }}
          >
            Show expo-camera
          </AppButton>
        </View>
      )}
    </MobilePhoneView>
  );
};
```

---

# Toward cross-platform interactive content

All these demos use React Native and Expo code, and they can run natively on React-Native, because the only rely on React-Native primitives.
These demos are embedded in this markdown post using [MDX](https://github.com/mdx-js/mdx).
Fortunately, MDX can be run on React-Native too!

This actually means that... **my posts are cross-platform**?

Stay tuned: in upcoming blog posts, I'll show you how I run my cross-platform MDX blog posts inside an Expo app.

![preview](./images/preview_smaller.png)

For a preview, scan my [Expo QRCode](https://expo.io/@slorber/sebastien-lorber), or take a look at the [source code](https://github.com/slorber/sebastienlorber.com) :)

![QRCode](./images/qrcode.png)

---

# Conclusion

Thank you for reading!

From now on, I hope to see all React-Native developers embedding interactive React-Native demos in their post!

We need more people to adopt cross-platform development today, to make it mainstream and polished. Jump on the bandwagon now!

---

If you like it, spread the word with a [Retweet]()

Browser code demos, or correct my post typos [on the blog repo](https://github.com/slorber/sebastienlorber.com/tree/master/content/posts/2020-05-08-using-expo-in-gatsby)

For more content like this, subscribe to [my mailing list](https://mailchi.mp/4ea4df0b54f7/sebastienlorber) and follow me on [Twitter](https://twitter.com/sebastienlorber).
